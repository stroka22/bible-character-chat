<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bible Character Chat - Improved</title>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&display=swap" rel="stylesheet">
    <style>
        /* Global Styles */
        :root {
            --blue-900: #0a0a2a;
            --blue-800: #1a1a4a;
            --blue-700: #2a2a6a;
            --yellow-400: #facc15;
            --yellow-500: #eab308;
            --yellow-600: #ca8a04;
            --white: #ffffff;
            --gray-100: #f3f4f6;
            --gray-200: #e5e7eb;
            --gray-300: #d1d5db;
            --gray-400: #9ca3af;
            --gray-500: #6b7280;
            --gray-600: #4b5563;
            --gray-700: #374151;
            --gray-800: #1f2937;
            --gray-900: #111827;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(to bottom, var(--blue-900), var(--blue-800), var(--blue-700));
            min-height: 100vh;
            color: #e0e0e0;
            padding: 0;
            margin: 0;
            overflow-x: hidden;
        }

        h1, h2, h3, h4 {
            font-family: 'Cinzel', serif;
        }

        /* Header Styles */
        .app-header {
            background-color: rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 100;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .app-title {
            color: var(--yellow-400);
            font-size: 1.8rem;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .app-nav {
            display: flex;
            gap: 1rem;
        }

        .nav-button {
            background-color: rgba(255, 255, 255, 0.1);
            color: var(--white);
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            border: 1px solid rgba(255, 255, 255, 0.2);
            cursor: pointer;
            transition: all 0.2s ease;
            font-family: 'Cinzel', serif;
            font-size: 0.9rem;
        }

        .nav-button:hover {
            background-color: rgba(255, 255, 255, 0.2);
        }

        .nav-button.active {
            background-color: var(--yellow-400);
            color: var(--blue-900);
            border-color: var(--yellow-600);
        }

        .main-content {
            padding-top: 5rem; /* Space for fixed header */
            min-height: calc(100vh - 5rem);
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* Character Selection Styles */
        .selection-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
            background-color: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.15);
            width: 100%;
        }

        .selection-title {
            font-size: 2.5rem;
            font-weight: bold;
            color: var(--yellow-400);
            text-align: center;
            margin-bottom: 20px;
            text-shadow: 0 0 15px rgba(250, 204, 21, 0.5);
        }

        .filter-section {
            background-color: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            justify-content: center;
            align-items: center;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            min-width: 150px;
        }

        .filter-section label {
            font-weight: bold;
            margin-bottom: 5px;
            color: var(--yellow-400);
        }

        .filter-section select,
        .filter-section input[type="text"] {
            background-color: rgba(255, 255, 255, 0.15);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            padding: 8px 12px;
            color: var(--white);
            outline: none;
        }

        .filter-section button {
            background-color: rgba(250, 204, 21, 0.2);
            border: 1px solid var(--yellow-400);
            color: var(--yellow-400);
            padding: 8px 15px;
            border-radius: 8px;
            cursor: pointer;
        }

        .filter-section button.active {
            background-color: var(--yellow-400);
            color: var(--blue-900);
            box-shadow: 0 0 10px rgba(250, 204, 21, 0.5);
        }

        .active-filters {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
            padding: 10px 15px;
            background-color: rgba(255, 255, 255, 0.03);
            border-radius: 10px;
        }

        .filter-chip {
            display: inline-flex;
            align-items: center;
            background-color: rgba(250, 204, 21, 0.2);
            color: var(--yellow-400);
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.9rem;
            border: 1px solid var(--yellow-400);
        }

        .filter-chip .remove {
            margin-left: 8px;
            width: 18px;
            height: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            background-color: rgba(255, 255, 255, 0.2);
            cursor: pointer;
        }

        .results-count {
            text-align: center;
            margin-bottom: 15px;
            font-size: 1.1rem;
            color: var(--white);
        }

        .view-toggle {
            display: flex;
            gap: 10px;
            margin-left: auto;
        }

        .view-toggle button {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            border-radius: 8px;
        }

        .character-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 25px;
            padding: 20px 0;
        }

        .character-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
            padding: 20px 0;
        }

        .character-card {
            background-color: rgba(255, 255, 255, 0.08);
            border-radius: 15px;
            padding: 25px 20px;
            text-align: center;
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.15);
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
            cursor: pointer;
        }

        .character-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 20px rgba(0, 0, 0, 0.3);
        }

        .character-card h3 {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--yellow-400);
            margin-bottom: 5px;
        }

        .character-card p {
            font-size: 0.9rem;
            color: var(--gray-200);
            line-height: 1.4;
        }

        .character-list-item {
            display: flex;
            align-items: center;
            background-color: rgba(255, 255, 255, 0.08);
            border-radius: 15px;
            padding: 15px;
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.15);
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
            cursor: pointer;
        }

        .character-list-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 20px rgba(0, 0, 0, 0.3);
        }

        .character-list-item .info {
            flex-grow: 1;
            text-align: left;
        }

        .character-list-item h3 {
            font-size: 1.3rem;
            font-weight: bold;
            color: var(--yellow-400);
            margin-bottom: 5px;
        }

        .character-list-item p {
            font-size: 0.9rem;
            color: var(--gray-200);
            line-height: 1.4;
        }

        .character-list-item .meta {
            font-size: 0.8rem;
            color: var(--gray-400);
            margin-top: 5px;
        }

        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            margin-top: 30px;
        }

        .pagination button {
            background-color: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: var(--white);
            width: 40px;
            height: 40px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }

        .pagination button.active {
            background-color: var(--yellow-400);
            color: var(--blue-900);
            border-color: var(--yellow-400);
            box-shadow: 0 0 10px rgba(250, 204, 21, 0.5);
        }

        .alpha-nav {
            position: fixed;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            display: flex;
            flex-direction: column;
            gap: 5px;
            background-color: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            padding: 10px 5px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            z-index: 50;
        }

        .alpha-nav a {
            width: 25px;
            height: 25px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--white);
            font-size: 0.8rem;
            border-radius: 50%;
            cursor: pointer;
            text-decoration: none;
        }

        .alpha-nav a:hover,
        .alpha-nav a.active {
            background-color: var(--yellow-400);
            color: var(--blue-900);
            box-shadow: 0 0 10px rgba(250, 204, 21, 0.5);
        }

        .featured-character {
            margin-bottom: 40px;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
        }

        .featured-character .halo {
            position: absolute;
            top: -15px;
            left: -15px;
            right: -15px;
            bottom: -15px;
            background: radial-gradient(circle, rgba(250, 204, 21, 0.5) 0%, rgba(250, 204, 21, 0) 70%);
            border-radius: 50%;
            z-index: 0;
        }

        .featured-character h2 {
            font-size: 2.2rem;
            font-weight: bold;
            color: var(--yellow-400);
            margin: 10px 0;
            text-shadow: 0 0 10px rgba(250, 204, 21, 0.4);
        }

        .featured-character p {
            max-width: 600px;
            color: var(--white);
            margin-bottom: 20px;
        }

        .featured-character button {
            background-color: var(--yellow-400);
            color: var(--blue-900);
            border: none;
            padding: 12px 24px;
            border-radius: 30px;
            font-weight: bold;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: 0 5px 15px rgba(250, 204, 21, 0.4);
        }

        .featured-character button:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(250, 204, 21, 0.6);
        }

        /* Chat Interface Styles - Based on mockup */
        .chat-container {
            display: flex;
            width: 100%;
            max-width: 1200px;
            height: 90vh;
            background-color: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.15);
            overflow: hidden;
            position: relative;
        }

        .chat-main {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            position: relative;
            z-index: 10;
            background-color: rgba(0, 0, 0, 0.1);
            transition: width 0.3s ease-in-out;
            width: 100%;
        }

        .chat-main.panel-open {
            width: calc(100% - 350px);
        }

        .chat-header {
            display: flex;
            align-items: center;
            padding: 15px 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            background-color: rgba(255, 255, 255, 0.05);
        }

        .chat-header img {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            object-fit: cover;
            margin-right: 15px;
            border: 2px solid var(--yellow-400);
        }

        .chat-header h2 {
            font-family: 'Cinzel', serif;
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--yellow-400);
        }

        .chat-messages {
            flex-grow: 1;
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .message-bubble {
            max-width: 70%;
            padding: 10px 15px;
            border-radius: 15px;
            line-height: 1.5;
        }

        .user-message {
            background-color: #4a5568;
            align-self: flex-end;
            border-bottom-right-radius: 2px;
        }

        .character-message {
            background-color: #2d3748;
            align-self: flex-start;
            border-bottom-left-radius: 2px;
        }

        .chat-input-area {
            padding: 15px 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            background-color: rgba(255, 255, 255, 0.05);
            display: flex;
            gap: 10px;
        }

        .chat-input-area input {
            flex-grow: 1;
            background-color: rgba(255, 255, 255, 0.15);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            padding: 10px 15px;
            color: #e0e0e0;
            outline: none;
            transition: border-color 0.2s ease, box-shadow 0.2s ease;
        }

        .chat-input-area input:focus {
            border-color: var(--yellow-400);
            box-shadow: 0 0 0 2px rgba(250, 204, 21, 0.3);
        }

        .chat-input-area input::placeholder {
            color: #a0aec0;
        }

        .chat-input-area button {
            background-color: var(--yellow-400);
            color: var(--blue-900);
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s ease-in-out;
            border: none;
        }

        .chat-input-area button:hover {
            background-color: #fbbf24;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .chat-input-area button:active {
            transform: translateY(0);
        }

        /* Insights Panel */
        .insights-panel {
            width: 350px;
            background: linear-gradient(to bottom, var(--blue-800), var(--blue-700));
            border-left: 1px solid rgba(255, 255, 255, 0.15);
            box-shadow: -5px 0 15px rgba(0, 0, 0, 0.2);
            padding: 20px;
            overflow-y: auto;
            transition: transform 0.3s ease-in-out;
            transform: translateX(100%);
            position: absolute;
            right: 0;
            top: 0;
            bottom: 0;
            z-index: 30;
        }

        .insights-panel.open {
            transform: translateX(0);
        }

        .insights-panel .portrait {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid var(--yellow-400);
            margin: 0 auto 15px;
            display: block;
        }

        .insights-panel h3 {
            font-family: 'Cinzel', serif;
            font-size: 1.8rem;
            color: var(--yellow-400);
            margin-bottom: 20px;
            text-align: center;
        }

        .insights-panel section {
            background-color: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: background-color 0.2s ease;
        }

        .insights-panel section:hover {
            background-color: rgba(255, 255, 255, 0.08);
        }

        .insights-panel section.collapsed .section-content {
            display: none;
        }

        .insights-panel section h4 {
            font-size: 1.2rem;
            color: #90cdf4;
            margin-bottom: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding-bottom: 5px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            user-select: none;
        }

        .insights-panel section h4:hover {
            color: #63b3ed;
        }

        .insights-panel section h4::after {
            content: '‚àí';
            font-size: 1.2rem;
            font-weight: bold;
            transition: transform 0.2s ease;
        }

        .insights-panel section.collapsed h4::after {
            content: '+';
        }

        .insights-panel p, .insights-panel ul, .insights-panel pre {
            font-size: 0.9rem;
            color: #c0c0c0;
            line-height: 1.5;
        }

        .insights-panel ul {
            list-style: disc;
            padding-left: 20px;
        }

        .insights-panel pre {
            background-color: rgba(0, 0, 0, 0.2);
            padding: 10px;
            border-radius: 5px;
            overflow-x: auto;
        }

        /* Relationships formatting */
        .relationship-group {
            margin-bottom: 12px;
        }

        .relationship-group h5 {
            font-weight: 600;
            color: var(--yellow-400);
            margin-bottom: 6px;
            font-size: 0.95rem;
        }

        .relationship-chip {
            display: inline-block;
            background-color: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 9999px;
            padding: 4px 10px;
            font-size: 0.8rem;
            margin: 2px 4px 6px 0;
            white-space: nowrap;
        }

        .insights-toggle-button {
            background-color: rgba(250, 204, 21, 0.2);
            border: 1px solid var(--yellow-400);
            color: var(--yellow-400);
            padding: 8px 15px;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s ease-in-out;
            margin-left: auto;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .insights-toggle-button:hover {
            background-color: var(--yellow-400);
            color: var(--blue-900);
            box-shadow: 0 0 10px rgba(250, 204, 21, 0.5);
            transform: translateY(-2px);
        }

        .insights-toggle-button:active {
            transform: translateY(0);
        }

        .insights-toggle-button.active {
            background-color: var(--yellow-400);
            color: var(--blue-900);
        }

        /* Close (X) button inside insights panel */
        .close-insights {
            position: absolute;
            top: 12px;
            right: 12px;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: rgba(250,204,21,0.15);
            border: 1px solid var(--yellow-400);
            color: var(--yellow-400);
            font-weight: bold;
            line-height: 28px;
            text-align: center;
            cursor: pointer;
            transition: all .2s ease;
        }

        .close-insights:hover {
            background: var(--yellow-400);
            color: var(--blue-900);
            transform: rotate(90deg);
        }

        /* Scripture Reference Popover */
        .scripture-reference {
            color: #63b3ed;
            text-decoration: underline;
            cursor: pointer;
            position: relative;
            display: inline-block;
            padding: 0 2px;
            border-radius: 3px;
            transition: background-color 0.2s ease;
        }

        .scripture-reference:hover {
            background-color: rgba(99, 179, 237, 0.2);
            text-decoration: none;
        }

        .scripture-popover {
            position: absolute;
            background-color: #fff;
            color: #333;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 10px 15px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            z-index: 100;
            width: 300px;
            max-width: 90vw;
            font-size: 0.85rem;
            line-height: 1.4;
            transform: translateX(-50%);
            left: 50%;
            bottom: calc(100% + 10px);
            pointer-events: none;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.2s ease, visibility 0.2s ease;
        }

        .scripture-reference:hover .scripture-popover {
            opacity: 1;
            visibility: visible;
        }

        .scripture-popover::after {
            content: '';
            position: absolute;
            left: 50%;
            bottom: -10px;
            transform: translateX(-50%);
            border-width: 5px;
            border-style: solid;
            border-color: #fff transparent transparent transparent;
        }

        .scripture-popover strong {
            display: block;
            margin-bottom: 5px;
            color: #2c5282;
            font-size: 0.9rem;
        }

        .scripture-popover p {
            margin-bottom: 5px;
            color: #2d3748;
        }

        .scripture-popover .attribution {
            font-size: 0.75rem;
            color: #718096;
            text-align: right;
            margin-top: 5px;
        }

        /* Breadcrumb and navigation */
        .breadcrumb {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .breadcrumb a {
            color: #e0e0e0;
            text-decoration: none;
            transition: color 0.2s ease;
        }

        .breadcrumb a:hover {
            color: var(--yellow-400);
        }

        .breadcrumb span.current {
            color: var(--yellow-400);
            font-weight: 600;
        }

        #backBtn {
            background-color: rgba(250, 204, 21, 0.15);
            border: 1px solid var(--yellow-400);
            color: var(--yellow-400);
            padding: 4px 12px;
            border-radius: 6px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        #backBtn:hover {
            background-color: var(--yellow-400);
            color: var(--blue-900);
            transform: translateY(-2px);
        }

        #backBtn:active {
            transform: translateY(0);
        }

        /* Scroll to top button */
        .scroll-top {
            position: fixed;
            bottom: 24px;
            right: 24px;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: rgba(250, 204, 21, 0.3);
            border: 1px solid var(--yellow-400);
            color: var(--yellow-400);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.2s ease;
            z-index: 90;
            display: none;
        }

        .scroll-top:hover {
            transform: translateY(-3px);
            background-color: var(--yellow-400);
            color: var(--blue-900);
        }

        /* View toggles */
        .selection-view {
            display: block;
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
        }

        .chat-view {
            display: none;
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
        }

        /* Responsive styles */
        @media (max-width: 768px) {
            .app-header {
                padding: 0.75rem 1rem;
            }

            .app-title {
                font-size: 1.4rem;
            }

            .selection-container {
                padding: 1rem;
                border-radius: 10px;
            }

            .selection-title {
                font-size: 2rem;
            }

            .filter-section {
                flex-direction: column;
                align-items: stretch;
            }

            .filter-group {
                width: 100%;
                margin-bottom: 12px;
            }

            .alpha-nav {
                position: static;
                transform: none;
                flex-direction: row;
                flex-wrap: wrap;
                justify-content: center;
                margin-top: 20px;
                width: 100%;
            }

            .character-grid {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            }

            .insights-panel {
                width: 100%;
            }

            .chat-main.panel-open {
                width: 0;
            }
        }
    </style>
</head>
<body>
    <!-- App Header -->
    <header class="app-header">
        <h1 class="app-title">Bible Character Chat</h1>
        <div class="app-nav">
            <button id="selectionViewBtn" class="nav-button active">Characters</button>
            <button id="chatViewBtn" class="nav-button">Chat</button>
        </div>
    </header>

    <!-- Main Content Area -->
    <main class="main-content">
        <!-- Character Selection View -->
        <div id="selectionView" class="selection-view">
            <div class="selection-container">
                <h1 class="selection-title">Choose Your Biblical Guide</h1>
                
                <!-- Featured Character -->
                <div class="featured-character">
                    <!-- Table-based circular image for featured character -->
                    <div style="position: relative; margin-bottom: 15px;">
                        <div class="halo"></div>
                        <table style="border-collapse: collapse; margin: 0 auto; position: relative; z-index: 1;">
                            <tr>
                                <td style="width: 120px; height: 120px; border-radius: 50%; overflow: hidden; border: 4px solid #facc15; box-shadow: 0 0 20px rgba(250, 204, 21, 0.6); padding: 0;">
                                    <img src="https://images.unsplash.com/photo-1518709268805-4e9042af9f23?auto=format&fit=crop&w=120&q=80" alt="Jesus" style="width: 120px; height: 120px; display: block; object-fit: cover;">
                                </td>
                            </tr>
                        </table>
                    </div>
                    <h2>Jesus</h2>
                    <p>The central figure of Christianity, Son of God who taught through parables and performed miracles.</p>
                    <button id="featuredCharacterBtn">Chat with Jesus üôè</button>
                </div>

                <div class="filter-section">
                    <div class="filter-group" style="flex-grow: 1;">
                        <label for="search">Search:</label>
                        <input type="text" id="search" placeholder="Search characters...">
                    </div>

                    <div class="filter-group">
                        <label>Testament:</label>
                        <div style="display: flex; gap: 8px;">
                            <button class="testament-filter active">All</button>
                            <button class="testament-filter">Old</button>
                            <button class="testament-filter">New</button>
                        </div>
                    </div>

                    <div class="filter-group">
                        <label for="book">Book:</label>
                        <select id="book">
                            <option value="all">All Books</option>
                            <optgroup label="Old Testament">
                                <option value="Genesis">Genesis</option>
                                <option value="Exodus">Exodus</option>
                                <option value="Psalms">Psalms</option>
                                <option value="Isaiah">Isaiah</option>
                            </optgroup>
                            <optgroup label="New Testament">
                                <option value="Matthew">Matthew</option>
                                <option value="John">John</option>
                                <option value="Acts">Acts</option>
                                <option value="Revelation">Revelation</option>
                            </optgroup>
                        </select>
                    </div>

                    <div class="filter-group">
                        <label for="group">Group:</label>
                        <select id="group">
                            <option value="all">All Groups</option>
                            <option value="Prophets">Prophets</option>
                            <option value="Apostles">Apostles</option>
                            <option value="Kings">Kings</option>
                            <option value="Women">Women of the Bible</option>
                        </select>
                    </div>

                    <div class="view-toggle">
                        <button id="gridViewBtn" class="active" title="Grid View">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <rect x="3" y="3" width="7" height="7"></rect>
                                <rect x="14" y="3" width="7" height="7"></rect>
                                <rect x="14" y="14" width="7" height="7"></rect>
                                <rect x="3" y="14" width="7" height="7"></rect>
                            </svg>
                        </button>
                        <button id="listViewBtn" title="List View">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <line x1="8" y1="6" x2="21" y2="6"></line>
                                <line x1="8" y1="12" x2="21" y2="12"></line>
                                <line x1="8" y1="18" x2="21" y2="18"></line>
                                <line x1="3" y1="6" x2="3.01" y2="6"></line>
                                <line x1="3" y1="12" x2="3.01" y2="12"></line>
                                <line x1="3" y1="18" x2="3.01" y2="18"></line>
                            </svg>
                        </button>
                    </div>
                </div>

                <div class="active-filters">
                    <span style="color: #a0a0a0; margin-right: 8px;">Active Filters:</span>
                    <!-- Filter chips will be added here dynamically -->
                </div>

                <div class="results-count">
                    <!-- Results count will be updated dynamically -->
                </div>

                <div id="character-container">
                    <div id="character-grid" class="character-grid"></div>
                    <div id="character-list" class="character-list" style="display:none;"></div>
                </div>

                <div class="pagination">
                    <!-- Pagination will be added here dynamically -->
                </div>
            </div>
        </div>

        <!-- Chat View (Based on mockup) -->
        <div id="chatView" class="chat-view">
            <div class="chat-container">
                <div class="chat-main" id="chatMain">
                    <!-- Breadcrumb + Back button -->
                    <div style="display: flex; align-items: center; justify-content: space-between; padding: 8px 16px; font-size: 0.875rem; background-color: rgba(255,255,255,.03); border-bottom: 1px solid rgba(255,255,255,.08);">
                        <div class="breadcrumb">
                            <a href="#" id="homeLink">Home</a>
                            <span>&gt;</span>
                            <a href="#" id="charactersLink">Characters</a>
                            <span>&gt;</span>
                            <span class="current" id="characterBreadcrumb">Character</span>
                        </div>
                        <button id="backBtn">Back to Characters</button>
                    </div>
                    
                    <div class="chat-header">
                        <img id="chatCharacterAvatar" src="https://images.unsplash.com/photo-1518709268805-4e9042af9f23?auto=format&fit=crop&w=100&q=80" alt="Character">
                        <h2 id="chatHeaderTitle">Chat with Character</h2>
                        <button id="insightsToggle" class="insights-toggle-button">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                                <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" />
                            </svg>
                            Insights
                        </button>
                        <button id="shareBtn" class="insights-toggle-button" style="margin-left: 8px;">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                                <path d="M15 8a3 3 0 100-6 3 3 0 000 6zM15 18a3 3 0 100-6 3 3 0 000 6zM5 13a3 3 0 100-6 3 3 0 000 6z" />
                                <path d="M8.59 7.51l2.83-1.31M8.59 12.49l2.83 1.31" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                            </svg>
                            Share
                        </button>
                    </div>

                    <div class="chat-messages" id="chatMessages">
                        <!-- Messages will be added here dynamically -->
                    </div>

                    <div class="chat-input-area">
                        <input type="text" id="chatInput" placeholder="Type your message...">
                        <button id="sendMessage">Send</button>
                    </div>
                </div>

                <div id="insightsPanel" class="insights-panel">
                    <!-- Close (X) button -->
                    <div id="closeInsights" class="close-insights">√ó</div>
                    <img id="insightsAvatar" class="portrait" src="https://images.unsplash.com/photo-1518709268805-4e9042af9f23?auto=format&fit=crop&w=150&q=80" alt="portrait">
                    <h3 id="insightsPanelTitle">Character Insights</h3>
                    
                    <section>
                        <h4 class="collapsible">Historical Context</h4>
                        <div class="section-content" id="historicalContext">
                            <!-- Historical context will be added here dynamically -->
                        </div>
                    </section>
                    
                    <section>
                        <h4 class="collapsible">Key Scripture References</h4>
                        <div class="section-content" id="scriptureReferences">
                            <!-- Scripture references will be added here dynamically -->
                        </div>
                    </section>
                    
                    <section>
                        <h4 class="collapsible">Theological Significance</h4>
                        <div class="section-content" id="theologicalSignificance">
                            <!-- Theological significance will be added here dynamically -->
                        </div>
                    </section>
                    
                    <section id="relationshipsSection">
                        <h4 class="collapsible">Relationships</h4>
                        <div class="section-content" id="relationships">
                            <!-- Relationships will be added here dynamically -->
                        </div>
                    </section>
                    
                    <section>
                        <h4 class="collapsible">Study Questions</h4>
                        <div class="section-content" id="studyQuestions">
                            <!-- Study questions will be added here dynamically -->
                        </div>
                    </section>
                </div>
            </div>
        </div>

        <!-- Alphabetical Navigation -->
        <div class="alpha-nav" id="alphaNav">
            <a class="active">All</a>
            <a>A</a>
            <a>B</a>
            <a>C</a>
            <a>D</a>
            <a>E</a>
            <a>F</a>
            <a>G</a>
            <a>H</a>
            <a>I</a>
            <a>J</a>
            <a>K</a>
            <a>L</a>
            <a>M</a>
            <a>N</a>
            <a>O</a>
            <a>P</a>
            <a>Q</a>
            <a>R</a>
            <a>S</a>
            <a>T</a>
            <a>U</a>
            <a>V</a>
            <a>W</a>
            <a>X</a>
            <a>Y</a>
            <a>Z</a>
        </div>
    </main>

    <!-- Scroll-to-Top Button -->
    <button id="scrollTopBtn" class="scroll-top">&#8679;</button>

    <script>
        /* ------------------------------------------------------------
         * Bible Character Chat - Improved Standalone Implementation
         * Combines character selection and chat functionality with
         * an enhanced UI based on the mockup design
         * ---------------------------------------------------------- */

        // Initialize characters globally
        window.characters = [
            {
                id: '1',
                name: 'Jesus',
                description: 'Central figure of Christianity who taught through parables and performed miracles.',
                testament: 'new',
                book: 'Matthew',
                group: 'Messiah',
                img: 'https://images.unsplash.com/photo-1518709268805-4e9042af9f23?auto=format&fit=crop&w=150&q=80',
                openingLine: 'Peace be with you. What would you like to know?',
                historicalContext: '<p><strong>Time Period:</strong> New Testament Era</p><p><strong>Location:</strong> Bethlehem, Nazareth, Jerusalem, Galilee</p><p>Born in Bethlehem, lived in Nazareth, ministered throughout Galilee and Judea under Roman rule. A time of significant religious and political tension between Jewish traditions and Roman occupation.</p>',
                theologicalSignificance: '<p>Jesus is the embodiment of God\'s love and salvation. He is the bridge between God and humanity, offering forgiveness of sins and eternal life through His sacrifice. His teachings emphasize love, compassion, justice, and the establishment of God\'s kingdom.</p>',
                scriptures: [
                    {
                        reference: 'John 3:16',
                        text: 'For God so loved the world, that he gave his only Son, that whoever believes in him should not perish but have eternal life.'
                    },
                    {
                        reference: 'Matthew 28:19-20',
                        text: 'Go therefore and make disciples of all nations, baptizing them in the name of the Father and of the Son and of the Holy Spirit, teaching them to observe all that I have commanded you. And behold, I am with you always, to the end of the age.'
                    },
                    {
                        reference: 'Philippians 2:5-11',
                        text: 'Have this mind among yourselves, which is yours in Christ Jesus, who, though he was in the form of God, did not count equality with God a thing to be grasped, but emptied himself, by taking the form of a servant, being born in the likeness of men. And being found in human form, he humbled himself by becoming obedient to the point of death, even death on a cross. Therefore God has highly exalted him and bestowed on him the name that is above every name, so that at the name of Jesus every knee should bow, in heaven and on earth and under the earth, and every tongue confess that Jesus Christ is Lord, to the glory of God the Father.'
                    }
                ],
                relationships: {
                    'disciples': ['Peter', 'James', 'John', 'Andrew', 'Philip', 'Bartholomew', 'Matthew', 'Thomas', 'James (son of Alphaeus)', 'Thaddaeus', 'Simon the Zealot', 'Judas Iscariot'],
                    'family': ['Mary', 'Joseph', 'James', 'Joses', 'Simon', 'Judas'],
                    'followers': ['Mary Magdalene', 'Martha', 'Lazarus']
                },
                studyQuestions: [
                    'What does it mean to truly love your neighbor?',
                    'How can one find peace in a troubled world?',
                    'What is the most important commandment?'
                ]
            },
            {
                id: '2',
                name: 'Mary',
                description: 'Mother of Jesus noted for her faith and obedience.',
                testament: 'new',
                book: 'Luke',
                group: 'Women',
                img: 'https://images.unsplash.com/photo-1591059683048-9a6208e91d2c?auto=format&fit=crop&w=150&q=80',
                openingLine: 'My soul magnifies the Lord. How may I help you understand God\'s ways?',
                historicalContext: '<p><strong>Time Period:</strong> New Testament Era</p><p><strong>Location:</strong> Nazareth, Bethlehem, Egypt, Jerusalem</p><p>Mary lived during the reign of Emperor Augustus and King Herod, in a time of Roman occupation of Israel. She was a young Jewish woman from Nazareth when chosen to be the mother of Jesus.</p>',
                theologicalSignificance: '<p>Mary represents the ideal of faithful obedience to God\'s will. Her willingness to accept God\'s plan despite potential social consequences demonstrates complete trust. She is honored as Theotokos ("God-bearer") and her Magnificat is one of the most beautiful expressions of praise in scripture.</p>',
                scriptures: [
                    {
                        reference: 'Luke 1:38',
                        text: 'And Mary said, "Behold, I am the servant of the Lord; let it be to me according to your word." And the angel departed from her.'
                    },
                    {
                        reference: 'Luke 1:46-55',
                        text: 'And Mary said, "My soul magnifies the Lord, and my spirit rejoices in God my Savior, for he has looked on the humble estate of his servant. For behold, from now on all generations will call me blessed; for he who is mighty has done great things for me, and holy is his name. And his mercy is for those who fear him from generation to generation. He has shown strength with his arm; he has scattered the proud in the thoughts of their hearts; he has brought down the mighty from their thrones and exalted those of humble estate; he has filled the hungry with good things, and the rich he has sent away empty. He has helped his servant Israel, in remembrance of his mercy, as he spoke to our fathers, to Abraham and to his offspring forever."'
                    },
                    {
                        reference: 'John 19:26-27',
                        text: 'When Jesus saw his mother and the disciple whom he loved standing nearby, he said to his mother, "Woman, behold, your son!" Then he said to the disciple, "Behold, your mother!" And from that hour the disciple took her to his own home.'
                    }
                ],
                relationships: {
                    'family': ['Jesus', 'Joseph', 'James', 'Joses', 'Simon', 'Judas'],
                    'relatives': ['Elizabeth', 'Zechariah', 'John the Baptist'],
                    'associates': ['The Disciples', 'Women at the Cross']
                },
                studyQuestions: [
                    'What qualities made Mary the chosen vessel for the Messiah?',
                    'How does Mary\'s Magnificat reveal her understanding of God?',
                    'What can we learn from Mary\'s faithful response to God\'s call?'
                ]
            },
            {
                id: '3',
                name: 'Peter',
                description: 'Disciple of Jesus and leader in the early church.',
                testament: 'new',
                book: 'Acts',
                group: 'Apostles',
                img: 'https://images.unsplash.com/photo-1542396601-dca920ea2807?auto=format&fit=crop&w=150&q=80',
                openingLine: 'Greetings in the name of our Lord Jesus Christ. What would you like to discuss?',
                historicalContext: '<p><strong>Time Period:</strong> New Testament Era</p><p><strong>Location:</strong> Galilee, Jerusalem, Rome</p><p>Peter was a fisherman from Capernaum who became one of Jesus\' closest disciples. After Jesus\' ascension, he became a prominent leader in the early church, preaching at Pentecost and traveling extensively to spread the gospel.</p>',
                theologicalSignificance: '<p>Peter represents both human weakness and divine empowerment. His journey from impulsive fisherman to church leader demonstrates how God transforms ordinary people for extraordinary purposes. His confession of Jesus as Messiah became foundational for Christian faith.</p>',
                scriptures: [
                    {
                        reference: 'Matthew 16:15-18',
                        text: 'He said to them, "But who do you say that I am?" Simon Peter replied, "You are the Christ, the Son of the living God." And Jesus answered him, "Blessed are you, Simon Bar-Jonah! For flesh and blood has not revealed this to you, but my Father who is in heaven. And I tell you, you are Peter, and on this rock I will build my church, and the gates of hell shall not prevail against it."'
                    },
                    {
                        reference: 'John 21:15-17',
                        text: 'When they had finished breakfast, Jesus said to Simon Peter, "Simon, son of John, do you love me more than these?" He said to him, "Yes, Lord; you know that I love you." He said to him, "Feed my lambs." He said to him a second time, "Simon, son of John, do you love me?" He said to him, "Yes, Lord; you know that I love you." He said to him, "Tend my sheep." He said to him the third time, "Simon, son of John, do you love me?" Peter was grieved because he said to him the third time, "Do you love me?" and he said to him, "Lord, you know everything; you know that I love you." Jesus said to him, "Feed my sheep."'
                    },
                    {
                        reference: 'Acts 2:38-39',
                        text: 'And Peter said to them, "Repent and be baptized every one of you in the name of Jesus Christ for the forgiveness of your sins, and you will receive the gift of the Holy Spirit. For the promise is for you and for your children and for all who are far off, everyone whom the Lord our God calls to himself."'
                    }
                ],
                relationships: {
                    'family': ['Andrew (brother)', 'Wife (unnamed)'],
                    'inner circle': ['Jesus', 'James', 'John'],
                    'fellow apostles': ['Matthew', 'Thomas', 'Philip', 'Bartholomew', 'James (son of Alphaeus)', 'Thaddaeus', 'Simon the Zealot', 'Judas Iscariot'],
                    'associates': ['Paul', 'Mark', 'Silas']
                },
                studyQuestions: [
                    'How did Peter\'s failures prepare him for leadership?',
                    'What does Peter\'s restoration after denying Jesus teach us about forgiveness?',
                    'How does Peter\'s transformation demonstrate the power of the Holy Spirit?'
                ]
            },
            {
                id: '4',
                name: 'Paul',
                description: 'Apostle to the Gentiles and prolific New-Testament author.',
                testament: 'new',
                book: 'Acts',
                group: 'Apostles',
                img: 'https://images.unsplash.com/photo-1504275107627-0c2ba7a43dba?auto=format&fit=crop&w=150&q=80',
                openingLine: 'Grace to you and peace from God our Father. What spiritual matters shall we explore today?',
                historicalContext: '<p><strong>Time Period:</strong> New Testament Era</p><p><strong>Location:</strong> Tarsus, Jerusalem, Asia Minor, Greece, Rome</p><p>Born as Saul of Tarsus, Paul was a Roman citizen and educated Pharisee who initially persecuted Christians. After his dramatic conversion, he became the foremost missionary to the Gentiles, establishing churches throughout the Roman Empire.</p>',
                theologicalSignificance: '<p>Paul\'s writings form the theological foundation for much of Christian doctrine. His emphasis on salvation by grace through faith, the unity of believers, and the work of the Holy Spirit have profoundly shaped Christian theology. His missionary journeys established Christianity as a worldwide faith rather than a Jewish sect.</p>',
                scriptures: [
                    {
                        reference: 'Romans 8:38-39',
                        text: 'For I am sure that neither death nor life, nor angels nor rulers, nor things present nor things to come, nor powers, nor height nor depth, nor anything else in all creation, will be able to separate us from the love of God in Christ Jesus our Lord.'
                    },
                    {
                        reference: '1 Corinthians 13:4-7',
                        text: 'Love is patient and kind; love does not envy or boast; it is not arrogant or rude. It does not insist on its own way; it is not irritable or resentful; it does not rejoice at wrongdoing, but rejoices with the truth. Love bears all things, believes all things, hopes all things, endures all things.'
                    },
                    {
                        reference: 'Philippians 4:13',
                        text: 'I can do all things through him who strengthens me.'
                    }
                ],
                relationships: {
                    'mentors': ['Gamaliel'],
                    'companions': ['Barnabas', 'Silas', 'Timothy', 'Luke', 'Titus'],
                    'converts': ['Lydia', 'Philippian Jailer', 'Onesimus'],
                    'associates': ['Aquila', 'Priscilla', 'Phoebe']
                },
                studyQuestions: [
                    'How did Paul\'s background as a Pharisee influence his understanding of Christ?',
                    'What is the significance of Paul\'s teaching on justification by faith?',
                    'How did Paul balance grace and obedience in his teachings?'
                ]
            },
            {
                id: '5',
                name: 'Moses',
                description: 'Led the Israelites out of Egypt and received the Ten Commandments.',
                testament: 'old',
                book: 'Exodus',
                group: 'Prophets',
                img: 'https://images.unsplash.com/photo-1566193232556-d3fd467e1712?auto=format&fit=crop&w=150&q=80',
                openingLine: 'I have witnessed the power of the Lord. What would you like to know about God\'s deliverance?',
                historicalContext: '<p><strong>Time Period:</strong> Approximately 1500-1400 BCE</p><p><strong>Location:</strong> Egypt, Sinai Peninsula, Wilderness</p><p>Moses was born during a time when the Israelites were enslaved in Egypt. He was raised in Pharaoh\'s household but later fled to Midian. God called him to return to Egypt and lead the Israelites to freedom, beginning the Exodus journey.</p>',
                theologicalSignificance: '<p>Moses is the great lawgiver and mediator between God and Israel. Through him, God established the covenant relationship with Israel, gave the Law, and instituted the sacrificial system. Moses represents God\'s justice and mercy, demonstrating how God works through imperfect human leaders to accomplish divine purposes.</p>',
                scriptures: [
                    {
                        reference: 'Exodus 3:14',
                        text: 'God said to Moses, "I AM WHO I AM." And he said, "Say this to the people of Israel: \'I AM has sent me to you.\'"'
                    },
                    {
                        reference: 'Exodus 20:1-17',
                        text: 'And God spoke all these words, saying, "I am the LORD your God, who brought you out of the land of Egypt, out of the house of slavery. You shall have no other gods before me..."'
                    },
                    {
                        reference: 'Deuteronomy 34:10-12',
                        text: 'And there has not arisen a prophet since in Israel like Moses, whom the LORD knew face to face, none like him for all the signs and the wonders that the LORD sent him to do in the land of Egypt, to Pharaoh and to all his servants and to all his land, and for all the mighty power and all the great deeds of terror that Moses did in the sight of all Israel.'
                    }
                ],
                relationships: {
                    'family': ['Amram (father)', 'Jochebed (mother)', 'Miriam (sister)', 'Aaron (brother)', 'Zipporah (wife)', 'Gershom (son)', 'Eliezer (son)'],
                    'associates': ['Jethro (father-in-law)', 'Joshua (successor)', 'Caleb', 'Pharaoh'],
                    'opponents': ['Pharaoh', 'Korah', 'Dathan', 'Abiram']
                },
                studyQuestions: [
                    'How did Moses\' upbringing in Egypt prepare him for his role as deliverer?',
                    'What can we learn from Moses\' encounters with God at the burning bush and on Mount Sinai?',
                    'How does Moses\' intercessory role prefigure Christ\'s mediation?'
                ]
            },
            {
                id: '6',
                name: 'David',
                description: 'Shepherd, psalmist and second king of Israel who defeated Goliath.',
                testament: 'old',
                book: '1 Samuel',
                group: 'Kings',
                img: 'https://images.unsplash.com/photo-1533073526757-2c8ca1df9f1c?auto=format&fit=crop&w=150&q=80',
                openingLine: 'The Lord is my shepherd. How may I share the wisdom God has given me?',
                historicalContext: '<p><strong>Time Period:</strong> Approximately 1000 BCE</p><p><strong>Location:</strong> Bethlehem, Jerusalem, Wilderness of Judah</p><p>David rose from humble beginnings as a shepherd boy to become Israel\'s greatest king. He established Jerusalem as the capital and expanded Israel\'s territory. His reign is considered the golden age of ancient Israel.</p>',
                theologicalSignificance: '<p>David is the archetypal king of Israel and ancestor of the Messiah. His psalms form the heart of Jewish and Christian worship. Despite his moral failures, he exemplifies genuine repentance and faith. God\'s covenant with David established the promise of an eternal kingdom fulfilled in Jesus Christ.</p>',
                scriptures: [
                    {
                        reference: '1 Samuel 16:7',
                        text: 'But the LORD said to Samuel, "Do not look on his appearance or on the height of his stature, because I have rejected him. For the LORD sees not as man sees: man looks on the outward appearance, but the LORD looks on the heart."'
                    },
                    {
                        reference: 'Psalm 23:1-6',
                        text: 'The LORD is my shepherd; I shall not want. He makes me lie down in green pastures. He leads me beside still waters. He restores my soul. He leads me in paths of righteousness for his name\'s sake. Even though I walk through the valley of the shadow of death, I will fear no evil, for you are with me; your rod and your staff, they comfort me. You prepare a table before me in the presence of my enemies; you anoint my head with oil; my cup overflows. Surely goodness and mercy shall follow me all the days of my life, and I shall dwell in the house of the LORD forever.'
                    },
                    {
                        reference: '2 Samuel 7:12-13',
                        text: 'When your days are fulfilled and you lie down with your fathers, I will raise up your offspring after you, who shall come from your body, and I will establish his kingdom. He shall build a house for my name, and I will establish the throne of his kingdom forever.'
                    }
                ],
                relationships: {
                    'family': ['Jesse (father)', 'Solomon (son)', 'Absalom (son)', 'Bathsheba (wife)'],
                    'friends': ['Jonathan', 'Hushai'],
                    'mentors': ['Samuel'],
                    'rivals': ['Saul', 'Goliath', 'Absalom']
                },
                studyQuestions: [
                    'What qualities made David "a man after God\'s own heart"?',
                    'How did David\'s experiences as a shepherd influence his understanding of God?',
                    'What can we learn from David\'s response to personal failure and sin?'
                ]
            },
            {
                id: '7',
                name: 'Abraham',
                description: 'Patriarch chosen by God and father of many nations.',
                testament: 'old',
                book: 'Genesis',
                group: 'Patriarchs',
                img: 'https://images.unsplash.com/photo-1470859624578-4bb64151d9be?auto=format&fit=crop&w=150&q=80',
                openingLine: 'Greetings. I have walked with God through many trials and blessings. What would you like to know?',
                historicalContext: '<p><strong>Time Period:</strong> Approximately 2000-1800 BCE</p><p><strong>Location:</strong> Ur, Haran, Canaan, Egypt</p><p>Abraham (originally called Abram) lived during the early Bronze Age. He migrated from Mesopotamia to Canaan in response to God\'s call. He lived as a nomadic herder and became the patriarch of the Hebrew people.</p>',
                theologicalSignificance: '<p>Abraham is the father of faith for Judaism, Christianity, and Islam. His unconditional trust in God\'s promises established the pattern of faith as belief in action. Through his covenant with God, Abraham became the channel of blessing for all nations, ultimately fulfilled in Christ.</p>',
                scriptures: [
                    {
                        reference: 'Genesis 12:1-3',
                        text: 'Now the LORD said to Abram, "Go from your country and your kindred and your father\'s house to the land that I will show you. And I will make of you a great nation, and I will bless you and make your name great, so that you will be a blessing. I will bless those who bless you, and him who dishonors you I will curse, and in you all the families of the earth shall be blessed."'
                    },
                    {
                        reference: 'Genesis 15:6',
                        text: 'And he believed the LORD, and he counted it to him as righteousness.'
                    },
                    {
                        reference: 'Genesis 22:8',
                        text: 'Abraham said, "God will provide for himself the lamb for a burnt offering, my son." So they went both of them together.'
                    }
                ],
                relationships: {
                    'family': ['Sarah (wife)', 'Isaac (son)', 'Ishmael (son)', 'Lot (nephew)', 'Terah (father)'],
                    'servants': ['Eliezer of Damascus', 'Hagar'],
                    'associates': ['Melchizedek', 'Abimelech', 'Pharaoh']
                },
                studyQuestions: [
                    'How does Abraham\'s journey of faith illustrate the nature of trust in God?',
                    'What does the testing of Abraham teach us about sacrifice and provision?',
                    'How does God\'s covenant with Abraham relate to salvation history?'
                ]
            },
            {
                id: '8',
                name: 'Esther',
                description: 'Jewish queen who bravely saved her people.',
                testament: 'old',
                book: 'Esther',
                group: 'Women',
                img: 'https://images.unsplash.com/photo-1502323777036-f29e3972f5ea?auto=format&fit=crop&w=150&q=80',
                openingLine: 'Perhaps you have come to your position for such a time as this. How may I help you?',
                historicalContext: '<p><strong>Time Period:</strong> Persian Empire, approximately 480-460 BCE</p><p><strong>Location:</strong> Susa (Shushan), capital of Persian Empire</p><p>Esther lived during the reign of King Xerxes (Ahasuerus), when many Jews remained in exile rather than returning to Jerusalem. As queen, she risked her life to prevent genocide against her people.</p>',
                theologicalSignificance: '<p>Though God is never explicitly mentioned in the book of Esther, divine providence is evident throughout. Esther demonstrates how God works through ordinary people and seemingly coincidental events to accomplish His purposes. Her story teaches courage, identity, and divine timing.</p>',
                scriptures: [
                    {
                        reference: 'Esther 4:14',
                        text: 'For if you keep silent at this time, relief and deliverance will rise for the Jews from another place, but you and your father\'s house will perish. And who knows whether you have not come to the kingdom for such a time as this?'
                    },
                    {
                        reference: 'Esther 4:16',
                        text: 'Go, gather all the Jews to be found in Susa, and hold a fast on my behalf, and do not eat or drink for three days, night or day. I and my young women will also fast as you do. Then I will go to the king, though it is against the law, and if I perish, I perish.'
                    },
                    {
                        reference: 'Esther 8:17',
                        text: 'And in every province and in every city, wherever the king\'s command and his edict reached, there was gladness and joy among the Jews, a feast and a holiday. And many from the peoples of the country declared themselves Jews, for fear of the Jews had fallen on them.'
                    }
                ],
                relationships: {
                    'family': ['Mordecai (cousin/guardian)'],
                    'royal court': ['King Xerxes (husband)', 'Hegai (keeper of women)'],
                    'enemies': ['Haman'],
                    'allies': ['Harbona']
                },
                studyQuestions: [
                    'How does Esther\'s story demonstrate God\'s providential care even when He seems absent?',
                    'What can we learn from Esther about courage and using one\'s position for good?',
                    'How does Esther\'s identity as both queen and Jew relate to our own dual identities as citizens of earth and heaven?'
                ]
            },
            {
                id: '9',
                name: 'John the Baptist',
                description: 'Prophet who prepared the way for Jesus.',
                testament: 'new',
                book: 'John',
                group: 'Prophets',
                img: 'https://images.unsplash.com/photo-1542856391-010fb87dcfed?auto=format&fit=crop&w=150&q=80',
                openingLine: 'Repent, for the kingdom of heaven is at hand! What do you seek?',
                historicalContext: '<p><strong>Time Period:</strong> New Testament Era, approximately 30 CE</p><p><strong>Location:</strong> Wilderness of Judea, Jordan River</p><p>John ministered during the Roman occupation of Judea, under the rule of Herod Antipas. He was the forerunner who prepared the way for Jesus, baptizing in the Jordan River and calling people to repentance.</p>',
                theologicalSignificance: '<p>John represents the culmination of Old Testament prophecy and the bridge to the New Testament era. His baptism of repentance prepared people for the Messiah, and his recognition of Jesus as "the Lamb of God" pointed to Christ\'s sacrificial mission. His humility in decreasing while Christ increased models proper spiritual priorities.</p>',
                scriptures: [
                    {
                        reference: 'Matthew 3:1-3',
                        text: 'In those days John the Baptist came preaching in the wilderness of Judea, "Repent, for the kingdom of heaven is at hand." For this is he who was spoken of by the prophet Isaiah when he said, "The voice of one crying in the wilderness: \'Prepare the way of the Lord; make his paths straight.\'"'
                    },
                    {
                        reference: 'John 1:29',
                        text: 'The next day he saw Jesus coming toward him, and said, "Behold, the Lamb of God, who takes away the sin of the world!"'
                    },
                    {
                        reference: 'John 3:30',
                        text: 'He must increase, but I must decrease.'
                    }
                ],
                relationships: {
                    'family': ['Zechariah (father)', 'Elizabeth (mother)'],
                    'relatives': ['Jesus (cousin)'],
                    'disciples': ['Andrew', 'Unnamed disciples']
                },
                studyQuestions: [
                    'What does John\'s message of repentance mean for believers today?',
                    'How does John\'s ministry fulfill Old Testament prophecy?',
                    'What can we learn from John\'s humility and focus on Christ?'
                ]
            }
        ];

        // Initialize the application when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM loaded, initializing character display');
            
            // DOM References
            const selectionViewBtn = document.getElementById('selectionViewBtn');
            const chatViewBtn = document.getElementById('chatViewBtn');
            const selectionView = document.getElementById('selectionView');
            const chatView = document.getElementById('chatView');
            const backBtn = document.getElementById('backBtn');
            const homeLink = document.getElementById('homeLink');
            const charactersLink = document.getElementById('charactersLink');
            const characterBreadcrumb = document.getElementById('characterBreadcrumb');
            
            // Chat Interface
            const chatMain = document.getElementById('chatMain');
            const chatCharacterAvatar = document.getElementById('chatCharacterAvatar');
            const chatHeaderTitle = document.getElementById('chatHeaderTitle');
            const chatMessages = document.getElementById('chatMessages');
            const chatInput = document.getElementById('chatInput');
            const sendMessage = document.getElementById('sendMessage');
            
            // Insights Panel
            const insightsToggle = document.getElementById('insightsToggle');
            const insightsPanel = document.getElementById('insightsPanel');
            const closeInsights = document.getElementById('closeInsights');
            const insightsAvatar = document.getElementById('insightsAvatar');
            const insightsPanelTitle = document.getElementById('insightsPanelTitle');
            const historicalContext = document.getElementById('historicalContext');
            const scriptureReferences = document.getElementById('scriptureReferences');
            const theologicalSignificance = document.getElementById('theologicalSignificance');
            const relationships = document.getElementById('relationships');
            const studyQuestions = document.getElementById('studyQuestions');
            const sections = document.querySelectorAll('.insights-panel section');
            
            // Share Button
            const shareBtn = document.getElementById('shareBtn');
            
            // Character Selection
            const gridEl = document.getElementById('character-grid');
            const listEl = document.getElementById('character-list');
            const resultCountEl = document.querySelector('.results-count');
            const featuredCharacterBtn = document.getElementById('featuredCharacterBtn');
            const gridViewBtn = document.getElementById('gridViewBtn');
            const listViewBtn = document.getElementById('listViewBtn');
            const alphaLinks = document.querySelectorAll('.alpha-nav a');
            const searchInput = document.getElementById('search');
            const testamentBtns = document.querySelectorAll('.testament-filter');
            const bookSelect = document.getElementById('book');
            const groupSelect = document.getElementById('group');
            
            // State
            let selectedCharacter = null;
            let chatHistory = [];
            let viewMode = 'grid';
            let currentPage = 1;
            let itemsPerPage = 9;
            const filters = { 
                search: '', 
                testament: 'all', 
                book: 'all', 
                group: 'all', 
                letter: 'All' 
            };
            
            // Function to select a character and switch to chat view
            function selectCharacter(character) {
                selectedCharacter = character;
                
                // Update chat interface with character info
                chatCharacterAvatar.src = character.img;
                chatCharacterAvatar.alt = character.name;
                chatHeaderTitle.textContent = `Chat with ${character.name}`;
                characterBreadcrumb.textContent = character.name;
                
                // Update insights panel
                insightsAvatar.src = character.img;
                insightsAvatar.alt = character.name;
                insightsPanelTitle.textContent = `${character.name} Insights`;
                
                // Set historical context
                if (character.historicalContext) {
                    historicalContext.innerHTML = character.historicalContext;
                } else {
                    historicalContext.innerHTML = '<p>No historical context available.</p>';
                }
                
                // Set theological significance
                if (character.theologicalSignificance) {
                    theologicalSignificance.innerHTML = character.theologicalSignificance;
                } else {
                    theologicalSign