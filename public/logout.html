<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Bible Character Chat - Logout</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      margin: 0;
      padding: 0;
      background: linear-gradient(to bottom, #1e3a8a, #2563eb, #3b82f6);
      color: white;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }
    .container {
      max-width: 600px;
      padding: 2rem;
      background-color: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
      border-radius: 12px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      margin: 0 1rem;
    }
    h1 {
      font-size: 2rem;
      margin-bottom: 1.5rem;
      text-align: center;
    }
    .button {
      display: inline-block;
      background-color: #f59e0b;
      color: #1e3a8a;
      font-weight: bold;
      padding: 0.75rem 1.5rem;
      border-radius: 9999px;
      text-decoration: none;
      margin-top: 1.5rem;
      border: none;
      cursor: pointer;
      font-size: 1rem;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      transition: background-color 0.2s;
    }
    .button:hover {
      background-color: #fbbf24;
    }
    .debug-panel {
      margin-top: 2rem;
      padding: 1rem;
      background-color: rgba(0, 0, 0, 0.2);
      border-radius: 8px;
      font-family: monospace;
      font-size: 0.875rem;
      white-space: pre-wrap;
      max-height: 200px;
      overflow-y: auto;
    }
    .success {
      color: #10b981;
      font-weight: bold;
    }
    .centered {
      text-align: center;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Logout Complete</h1>
    
    <div class="centered">
      <p>You have been successfully logged out of Bible Character Chat.</p>
      <p class="success">✓ All session data has been cleared</p>
      
      <a href="/login" class="button">Return to Login</a>
    </div>
    
    <div class="debug-panel" id="debugPanel">
      Clearing storage...
    </div>
  </div>

  <script>
    // Function to log to the debug panel
    function logToDebug(message) {
      const debugPanel = document.getElementById('debugPanel');
      const timestamp = new Date().toLocaleTimeString();
      debugPanel.innerHTML += `\n[${timestamp}] ${message}`;
      console.log(message);
    }

    // Function to clear all storage
    function clearAllStorage() {
      // Track what was cleared
      const cleared = {
        localStorage: false,
        sessionStorage: false,
        cookies: false
      };

      // Clear localStorage
      try {
        const localStorageKeys = Object.keys(localStorage);
        logToDebug(`Found ${localStorageKeys.length} localStorage items`);
        
        if (localStorageKeys.length > 0) {
          logToDebug(`localStorage keys: ${localStorageKeys.join(', ')}`);
        }
        
        localStorage.clear();
        cleared.localStorage = true;
        logToDebug("✓ localStorage cleared");
      } catch (e) {
        logToDebug(`❌ Error clearing localStorage: ${e.message}`);
      }

      // Clear sessionStorage
      try {
        const sessionStorageKeys = Object.keys(sessionStorage);
        logToDebug(`Found ${sessionStorageKeys.length} sessionStorage items`);
        
        if (sessionStorageKeys.length > 0) {
          logToDebug(`sessionStorage keys: ${sessionStorageKeys.join(', ')}`);
        }
        
        sessionStorage.clear();
        cleared.sessionStorage = true;
        logToDebug("✓ sessionStorage cleared");
      } catch (e) {
        logToDebug(`❌ Error clearing sessionStorage: ${e.message}`);
      }

      // Clear cookies
      try {
        const cookies = document.cookie.split(";");
        logToDebug(`Found ${cookies.length} cookies`);
        
        if (cookies.length > 0 && cookies[0] !== "") {
          logToDebug(`Cookies: ${cookies.join(', ')}`);
          
          for (let i = 0; i < cookies.length; i++) {
            const cookie = cookies[i];
            const eqPos = cookie.indexOf("=");
            const name = eqPos > -1 ? cookie.substring(0, eqPos).trim() : cookie.trim();
            document.cookie = name + "=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/";
          }
        }
        
        cleared.cookies = true;
        logToDebug("✓ Cookies cleared");
      } catch (e) {
        logToDebug(`❌ Error clearing cookies: ${e.message}`);
      }

      // Summary
      logToDebug("\n--- Logout Summary ---");
      logToDebug(`localStorage: ${cleared.localStorage ? "Cleared ✓" : "Failed ❌"}`);
      logToDebug(`sessionStorage: ${cleared.sessionStorage ? "Cleared ✓" : "Failed ❌"}`);
      logToDebug(`cookies: ${cleared.cookies ? "Cleared ✓" : "Failed ❌"}`);
      logToDebug("---------------------");
    }

    // Run when the page loads
    document.addEventListener('DOMContentLoaded', function() {
      logToDebug("Starting logout process...");
      clearAllStorage();
      logToDebug("Logout complete. You can now return to login.");
    });
  </script>
</body>
</html>
